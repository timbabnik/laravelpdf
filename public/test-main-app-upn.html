<!DOCTYPE html>
<html>
<head>
    <title>Main App UPN Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-container { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .qr-code { border: 2px solid #28a745; padding: 10px; margin: 10px 0; max-width: 200px; }
        button { padding: 15px 30px; font-size: 18px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 20px 0; }
        .instructions { background: #d4edda; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
    </style>
</head>
<body>
    <h1>🏠 Main App UPN Test</h1>
    
    <div class="instructions">
        <h3>🎯 Testing Main App UPN Generation</h3>
        <p><strong>Go to the main app:</strong> <a href="/invoice-extractor" target="_blank">Invoice Extractor</a></p>
        <p><strong>Steps:</strong></p>
        <ol>
            <li>Upload any PDF invoice</li>
            <li>Wait for data extraction</li>
            <li>In the modal, select "UPN Format (Works with NLB Klik/Flik)"</li>
            <li>Click "Generate QR Code"</li>
            <li>Test the generated QR code with NLB Klik/Flik</li>
        </ol>
    </div>
    
    <div class="test-container success">
        <h3>🔧 UPN Format Fixes Applied:</h3>
        <ul>
            <li>✅ <strong>Line Endings:</strong> CRLF (\r\n) instead of LF (\n)</li>
            <li>✅ <strong>Encoding:</strong> Windows-1250 instead of UTF-8</li>
            <li>✅ <strong>Field Order:</strong> Official UPN specification</li>
            <li>✅ <strong>Format:</strong> 34-line minimal UPN schema</li>
            <li>✅ <strong>Real IBAN:</strong> SI56 0203 1367 1566 113</li>
        </ul>
        
        <h3>📱 Test Instructions:</h3>
        <ol>
            <li><strong>Go to main app:</strong> <a href="/invoice-extractor" target="_blank">Click here</a></li>
            <li><strong>Upload PDF:</strong> Any invoice PDF</li>
            <li><strong>Select UPN Format:</strong> Choose "UPN Format (Works with NLB Klik/Flik)"</li>
            <li><strong>Generate QR:</strong> Click "Generate QR Code"</li>
            <li><strong>Test with NLB Klik:</strong> "Plačila" → "Slikaj in plačaj"</li>
            <li><strong>Test with NLB Flik:</strong> Scan the QR code</li>
        </ol>
        
        <h3>🎯 Expected Results:</h3>
        <ul>
            <li><strong>NLB Klik:</strong> Should work or show different error (not "validacija neuspesna")</li>
            <li><strong>NLB Flik:</strong> Should work or show different error (not "napacna qr koda")</li>
            <li><strong>Success:</strong> Should show "Plačilo UPN" option</li>
        </ul>
    </div>
    
    <div class="test-container">
        <h3>🔍 Alternative Test:</h3>
        <p>If you want to test the corrected format directly:</p>
        <button onclick="window.open('/test-corrected-upn.html', '_blank')">Open Corrected UPN Test</button>
    </div>
</body>
</html>
